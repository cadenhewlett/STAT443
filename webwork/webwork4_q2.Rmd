--
title: "WWK4-Q2"
author: "STAT443"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(zoo)
library(tseries)
library(forecast)
```

# Question 1

The data available to download above are end-of-week closing prices for Accenture PLC, a company listed on the New York stock exchange. The data run from a week in 2010 until the end of November 2014. Plot the data in R, and examine the acf and pacf (note you may find the index function useful for resetting the time index to integers). Using the R command HoltWinters , create an object of class HoltWinters in R which is the result of applying simple exponential smoothing to your time series data. Plot the object.


```{r}
df =read.csv("file49b38b157b9.csv")
#df =read.csv("443ww4file.csv")
# series = ts(df$x,
#    start = c(2010, 01), 
#    end = c(2014, 11),
#    frequency = 52)
# plot(series)
plot( index(df$X), df$x, type = 'l')
#?as.ts
series = ts(df$x, 
               start = c(1, 2010), 
               frequency = 7)
```

```{r}
acf(series, main="ACF of Accenture PLC Closing Prices")
pacf(series, main="PACF of Accenture PLC Closing Prices")
```
Simple HW Smoothing
```{r}
hw = HoltWinters(series )
plot(hw)
```

```{r}
round(hw$alpha, 3)
```

```{r}
as.numeric(round(predict(hw, n.ahead = 1), 3))
```

## Comparing Methods

```{r}
fit_alpha_0.3 <- ses(series, alpha=0.3)
plot(fit_alpha_0.3, main="Exponential Smoothing with Alpha = 0.3")
```

Method **D**: Holt's Exponential
```{r}
fit_holt <- holt(series)
plot(fit_holt, main="Holt's Exponential Smoothing")
```

There's a trend, but no obvious season, so Holt's Exponential is best. 

Let's verify with the training error as a litmus test.
```{r}
sum( fit_alpha_0.3$residuals^2) # rss alpha = 0.3
sum( fit_holt$residuals^2)
sum(residuals(hw)^2)
```

Now, we predict one ahead:
```{r}
?HoltWinters
# hw_forecast <- predict(fit_holt, n.ahead=1)
# 
# # The forecasted value is
# hw_forecast_value <- hw_forecast
# print(hw_forecast_value)
```
```{r}
qd = round( forecast(fit_holt, h=1)$mean, 3)

new_holt = HoltWinters(series, beta = FALSE)
```

## MY WORK

```{r}
print(paste("Question A:", "B"))
print(paste("Question B:", round(hw$alpha, 3)))
print(paste("Question C:", as.numeric(round(predict(hw, n.ahead = 1), 3))))
print(paste("Question D:", "D"))
print(paste("Question E:", round( as.numeric( predict(new_holt, n.ahead = 1) ), 3)))
new_holt = HoltWinters(series)

# define hw object
hw <- HoltWinters(series)
# make prediction
pred = predict(hw, n.ahead = 1)
# round
round(pred, 3)
# numeric version
as.numeric(round(pred, 3))
pred
```

## ??
```{r}
test_holtwinter = HoltWinters(series, gamma = FALSE, seasonal = "multiplicative")
test_holt = HoltWinters(series, gamma = FALSE, beta = FALSE, seasonal = "multiplicative")
as.numeric(predict(test_holtwinter, n.ahead = 1))
as.numeric(predict(test_holt, n.ahead = 1))
as.numeric(test_holtwinter$alpha)
```