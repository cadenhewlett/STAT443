---
title: "Stat 443: Time Series and Forecasting"
subtitle: "Assignment 4: Analysis in the Frequency Domain"
author: Caden Hewlett
header-includes:
    - \usepackage{bbm}
    - \usepackage{amsmath}
    - \usepackage{mathrsfs}
    - \usepackage{yfonts}
date: "`r format(Sys.Date(), '%B %d, %Y')`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tseries)
library(ggplot2)
library(gridExtra)
library(reshape2)
library(forecast)
library(ggfortify)
library(grid)
library(gt)
library(gtExtras)
library(knitr)
library(readr)
library(tidyverse)
library(lubridate)
library(xts)
library(kableExtra)
library(extraDistr)
library(pracma)
library(distr)
library(latex2exp)
library(rstan)
library(reticulate)
require(dplyr, quietly = TRUE)
```


# Question 1

Consider the following second-order AR process AR$(2)$ process for $\{X_t\}_{t \in \mathbb{Z}}$, where $\{Z_t\}_{t \in \mathbb{Z}} \overset{\text{iid}}{\sim} \text{WN}(0, \sigma^2)$.


$$
X_t = \frac{7}{10}X_{t-1} - \frac{1}{10}X_{t-2} + Z_t
$$


We have previously shown that the autocorrelation function $\gamma(h)$ for $h \in \mathbb{Z}$ is given by:

$$
\rho(h) =  \frac{16}{11}\Big(\frac{1}{2}\Big)^{|h|}-\frac{5}{11}\Big(\frac{1}{5}\Big)^{|h|}, \hspace{0.5cm} h \in \mathbb{Z}
$$

## Part A

Derive the normalized spectral density function $f^{\star}(\omega)$ for  $\{X_t\}_{t \in \mathbb{Z}}$.

**Solution**

We begin by verifying that the Fourier Transform is well defined.

$$
\begin{aligned}
\sum_{h = -\infty}^{\infty}|\rho(h)| &= \sum_{h = -\infty}^{\infty} \bigg|\frac{16}{11}\Big(\frac{1}{2}\Big)^{|h|}-\frac{5}{11}\Big(\frac{1}{5}\Big)^{|h|}\bigg| \; {\overset{\text{?}}{<}} \;\infty  \\
\sum_{t = -\infty}^{\infty}|\rho(h)| &= \Big(\frac{16}{11} - \frac{5}{11}\Big) + 2 \bigg(\frac{16}{11}\sum_{h = 1}^{\infty}\Big(\frac{1}{2}\Big)^{h}-\frac{5}{11}\sum_{h = 1}^{\infty}\Big(\frac{1}{5}\Big)^{h}\bigg) \\
\sum_{t = -\infty}^{\infty}|\rho(h)| &= 1 + 2 \bigg(\frac{16}{11}\Big( \frac{1/2}{1 - 1/2}\Big)-\frac{5}{11}  \Big( \frac{1/5}{1 - 1/5}\Big)\bigg) \\
\sum_{t = -\infty}^{\infty}|\rho(h)| &= 1 + 2 \bigg(\frac{16}{11}-\frac{5}{11}\Big(\frac{1}{4} \Big)\bigg) = \boxed{\frac{81}{22} < \infty, \; \therefore \text{well-defined. }}
\end{aligned}
$$


Now, we evaluate given $\rho$, recalling that for $\omega \in (0,1)$ and even functions, the normalized spectral density is given by:
$$
f^{\star}(\omega) = \dfrac{1}{\pi}\bigg(\rho(0) + 2\sum_{h = 1}^{\infty} \rho(h) \cos(\omega h)\bigg), \hspace{0.5cm} \omega \in (0,1)
$$
Where  $\rho(0) = 1$.


We will evaluate the infinite sum and substitute the result into the equation above. We will re-instate coefficients $A_1$ and $A_2$ from the previous assignment during intermediate steps for simplicity. In addition, we will let $d_1 = 1/2$ and $d_2 = 1/5$, noting that the geometric series equation is usable here as $|d_1|$ and $|d_2|$ are both less than $1$.
$$
\begin{aligned}
\sum_{h = 1}^\infty \rho(h)\cos(\omega h) &= \sum_{h = 1}^\infty \bigg(\frac{16}{11}\Big(\frac{1}{2}\Big)^{|h|}-\frac{5}{11}\Big(\frac{1}{5}\Big)^{|h|}\bigg)\cos(\omega h) \\
\sum_{h = 1}^\infty \rho(h)\cos(\omega h) &= \sum_{h = 1}^\infty \bigg(A_1(d_1)^{|h|}-A_2(d_2)^{|h|}\bigg)\cos(\omega h), \hspace{0.25cm} \text{ using variable form.}\\
\sum_{h = 1}^\infty \rho(h)\cos(\omega h) &= \underbrace{\sum_{h = 1}^\infty \bigg(A_1(d_1)^{|h|}\cos(\omega h)  \bigg)}_{\text{Term 1}}- \underbrace{\sum_{h = 1}^\infty \bigg(A_2(d_2)^{|h|}\cos(\omega h) \bigg)}_{\text{Term 2}}
\end{aligned}
$$
We will evaluate Term 1 and Term 2 separately. We will use the following identities without proof:
$$\cos(\omega h) = \frac{1}{2}\Big(e^{\mathfrak{i} h \omega} +  e^{-\mathfrak{i} h \omega}\Big), \hspace{0.5cm} \mathfrak{i} = \sqrt{-1} \tag{1}$$
$$
\sum_{n = 1}^{\infty} a\cdot r^{n} = \frac{ar}{(1-r)}, \hspace{0.5cm} |r| < 1, \; a \in \mathbb{R} \tag{2}
$$

Evaluating Term 1, noting that $|h| = h$ since the summation spans $h \in \mathbb{Z}^{+}$.
$$
\begin{aligned}
\sum_{h = 1}^\infty \bigg(A_1(d_1)^{|h|}\cos(\omega h)  \bigg) &= A_1 \sum_{h = 1}^\infty (d_1)^{|h|}\Big(\frac{1}{2}\Big(e^{\mathfrak{i} h \omega} +  e^{-\mathfrak{i} h \omega}\Big)\Big), \hspace{0.5cm} \text{by  (1)} \\
\sum_{h = 1}^\infty \bigg(A_1(d_1)^{|h|}\cos(\omega h)  \bigg) &= \frac{A_1}{2} \sum_{h = 1}^\infty (d_1)^{h}\Big(e^{\mathfrak{i} h \omega} +  e^{-\mathfrak{i} h \omega}\Big)\\
\sum_{h = 1}^\infty \bigg(A_1(d_1)^{|h|}\cos(\omega h)  \bigg) &= \frac{A_1}{2}\bigg( \sum_{h = 1}^\infty (d_1)^{h}e^{\mathfrak{i} h \omega} +  \sum_{h = 1}^\infty (d_1)^{h}e^{-\mathfrak{i} h \omega}\bigg)\\
\sum_{h = 1}^\infty \bigg(A_1(d_1)^{|h|}\cos(\omega h)  \bigg) &= \frac{A_1}{2}\bigg( \sum_{h = 1}^\infty \Big(d_1\,e^{\mathfrak{i} \omega}\Big)^{h} +  \sum_{h = 1}^\infty \Big(d_1e^{-\mathfrak{i} \omega}\Big)^{h}\bigg)\\
\sum_{h = 1}^\infty \bigg(A_1(d_1)^{|h|}\cos(\omega h)  \bigg) &= \frac{A_1}{2}\bigg( \frac{d_1e^{\mathfrak{i}\omega}}{1 - d_1e^{\mathfrak{i}\omega}} + \frac{d_1e^{-\mathfrak{i}\omega}}{1 - d_1e^{-\mathfrak{i}\omega}} \bigg), \hspace{0.5cm} \text{by  (2)}\\
\sum_{h = 1}^\infty \bigg(A_1(d_1)^{|h|}\cos(\omega h)  \bigg) &= \frac{A_1}{2}\bigg( \frac{d_1e^{\mathfrak{i}\omega}(1 - d_1e^{-\mathfrak{i}\omega})+ d_1e^{-\mathfrak{i}\omega}(1 - d_1e^{\mathfrak{i}\omega} )}{(1 - d_1e^{\mathfrak{i}\omega} )(1 - d_1e^{-\mathfrak{i}\omega})} \bigg) \\
\sum_{h = 1}^\infty \bigg(A_1(d_1)^{|h|}\cos(\omega h)  \bigg) &= \frac{A_1}{2}\bigg( \frac{d_1(e^{\mathfrak{i} \omega} + e^{-\mathfrak{i} \omega}) - 2d_1^2}{1 - d_1(e^{\mathfrak{i} \omega} + e^{-\mathfrak{i} \omega}) + d_1^2} \bigg) \\
\sum_{h = 1}^\infty \bigg(A_1(d_1)^{|h|}\cos(\omega h)  \bigg) &= \frac{A_1}{2}\bigg( \frac{2d_1\cos(\omega) - 2d_1^2}{1 - 2d_1\cos(\omega) + d_1^2} \bigg) \\
\sum_{h = 1}^\infty \bigg(A_1(d_1)^{|h|}\cos(\omega h)  \bigg) &= \frac{A_1(d_1\cos(\omega) - d_1^2)}{1 - 2d_1\cos(\omega) + d_1^2} \\
\end{aligned}
$$
Similarly, if we repeat this exact same process with $A_2$ and $d_2$, noting that $|d_2| < 1$ and $A_2 \in \mathbb{R}$ also satisfy the requirements of $(1)$ and $(2)$, we arrive at Term 2:
$$
\sum_{h = 1}^\infty \bigg(A_2(d_2)^{|h|}\cos(\omega h)  \bigg) = \frac{A_2(d_2\cos(\omega) - d_2^2)}{1 - 2d_2\cos(\omega) + d_2^2} 
$$
Then, we can recombine these into our original expression for the infinite sum:
$$
\begin{aligned}
\sum_{h = 1}^\infty \rho(h)\cos(\omega h) &= {\sum_{h = 1}^\infty \bigg(A_1(d_1)^{|h|}\cos(\omega h)  \bigg)}- {\sum_{h = 1}^\infty \bigg(A_2(d_2)^{|h|}\cos(\omega h) \bigg)} \\
\sum_{h = 1}^\infty \rho(h)\cos(\omega h) &=  \frac{A_1(d_1\cos(\omega) - d_1^2)}{1 - 2d_1\cos(\omega) + d_1^2}- \frac{A_2(d_2\cos(\omega) - d_2^2)}{1 - 2d_2\cos(\omega) + d_2^2}  \\
\sum_{h = 1}^\infty \rho(h)\cos(\omega h) &= \Big(\frac{16}{11} \Big)\frac{(\frac{1}{2}\cos(\omega) - \big(\frac{1}{2}\big)^2)}{1 - 2\big(\frac{1}{2}\big)\cos(\omega) + \big(\frac{1}{2}\big)^2}- \Big( \frac{5}{11} \Big)\frac{(\frac{1}{5}\cos(\omega) - (\frac{1}{5})^2)}{1 - 2(\frac{1}{5})\cos(\omega) + (\frac{1}{5})^2} \\
\sum_{h = 1}^\infty \rho(h)\cos(\omega h) &= \Big(\frac{16}{11} \Big)\frac{2\cos(\omega) - 1}{5 - 4\cos(\omega)}- \Big(\frac{5}{11}  \Big)\dfrac{5\cos(\omega) - 1}{2(13 - 5\cos(\omega))}
\end{aligned}
$$

Then, combining the expressions we can get the final expression for the normalized spectral density:
$$
\begin{aligned}
f^{\star}(\omega) &= \dfrac{1}{\pi}\bigg(1 + 2\sum_{h = 1}^{\infty} \rho(h) \cos(\omega h)\bigg) \\
f^{\star}(\omega) &= \dfrac{1}{\pi}\bigg(1 + 2\bigg(\Big(\frac{16}{11} \Big)\frac{2\cos(\omega) - 1}{5 - 4\cos(\omega)}- \Big(\frac{5}{11}  \Big)\dfrac{5\cos(\omega) - 1}{2(13 - 5\cos(\omega))}\bigg) \bigg)\\
f^{\star}(\omega) &= \boxed{\dfrac{1}{\pi} + \frac{32}{11 \pi} \bigg(\frac{2\cos(\omega) - 1}{5 - 4\cos(\omega)}\bigg)- \frac{5}{11 \pi}  \bigg(\dfrac{5\cos(\omega) - 1}{13 - 5\cos(\omega)}\bigg)}
\end{aligned}
$$
We can verify these results below:
```{r}
w = pi/4
# define acf
rho <- function(h){  (16/11)*((1/2)^h) - (5/11)*((1/5)^h) }
# define the "infinite sum"
sum_vals = sum(sapply(1:1000, function(h){
  rho(h)*cos(w*h)
}))
# from the equation... 
eqnval = (1/pi)*(rho(0) + 2*sum_vals)

# from our simplification
fw1 = 1/pi 
fw2 = (32/(11*pi)) * ( (2 * cos(w) - 1) / (5 - 4*cos(w)) )
fw3 = (5/(11*pi)) * ( (5 * cos(w) - 1) / (13 - 5*cos(w)) )
# comparison
c(eqnval, fw1 + fw2 - fw3)
```
We see that the values are identical for at least the first $10,000$ lags at fixed $\omega = \pi/4$.

\newpage
## Part B

Write down the power spectral density function of $\{X_t\}_{t \in \mathbb{Z}}$.


**Solution**

We recall from the definition of normalized spectral density that
$$
f^{\star}(\omega) = \dfrac{f(\omega)}{\sigma^2_X}
$$
Where $\sigma^2_X$ is the variance of $\{X_t\}_{t \in \mathbb{Z}}$.

Directly, then, we can write $f(\omega)$ as:
$$
f(\omega) = \sigma^2_Xf^{\star}(\omega)  = \gamma(0)f^{\star}(\omega)
$$

We re-establish the Yule-Walker equations, where $\alpha_1 = 7/10$ and $\alpha_2 = -1/10$ 

$$
\begin{aligned}
\mathbb{E}(X_tX_{t})  &= \alpha_1\mathbb{E}(X_{t}X_{t-1}) - \alpha_2\mathbb{E}(X_{t}X_{t-2}) + \mathbb{E}(X_t Z_t)\\
\mathbb{E}(X_tX_{t-1}) &= \alpha_1\mathbb{E}(X_{t-1}X_{t-1}) - \alpha_2\mathbb{E}(X_{t-1}X_{t-2}) + \mathbb{E}(Z_tX_{t-1}) \\
\mathbb{E}(X_tX_{t-2}) &= \alpha_1\mathbb{E}(X_{t-1}X_{t-2}) - \alpha_2\mathbb{E}(X_{t-2}X_{t-2}) + \mathbb{E}(Z_tX_{t-2})
\end{aligned}
$$
Which becomes the following system of three equations: 
$$
\begin{aligned}
\gamma(0)  &= \alpha_1 \gamma(1) + \alpha_2 \gamma(2) + \sigma^2\\
\gamma(1)  &= \alpha_1\gamma(0) + \alpha_2\gamma(1) \\
\gamma(2)  &= \alpha_1\gamma(1) + \alpha_2\gamma(0) \\
\end{aligned}
$$
test area:
$$
\begin{aligned}
\gamma(1) = \alpha_1 \gamma(0) + \alpha_2 \gamma(1) \\
\gamma(1) = \frac{\alpha_1}{1-\alpha_2} \gamma(0)
\end{aligned}
$$
then
$$
\begin{aligned}
\gamma(2) = \alpha_1 \gamma(1) + \alpha_2 \gamma(0) \\
\gamma(2) = \alpha_1 \Big(\frac{\alpha_1}{1-\alpha_2} \gamma(0)\Big)+ \alpha_2 \gamma(0)  \\
\gamma(2) = \Big(\frac{\alpha_1^2 + \alpha_2 - \alpha_2^2}{1-\alpha_2} \Big)\gamma(0)
\end{aligned}
$$
finally
$$
\begin{aligned}
&\gamma(0) =\alpha_1 \gamma(1) + \alpha_2 \gamma(2) + \sigma^2 \\
&\gamma(0) =\alpha_1  \Big(\frac{\alpha_1}{1-\alpha_2}\Big) \gamma(0)+ \alpha_2\Big(\frac{\alpha_1^2 + \alpha_2 - \alpha_2^2}{1-\alpha_2} \Big)\gamma(0) + \sigma^2 \\
&\gamma(0) = \Big(\frac{\alpha_1^2 +\alpha_1^2\alpha_2 + \alpha_2^2 - \alpha_2^3}{1-\alpha_2} \Big)\gamma(0) + \sigma^2 \\
&\gamma(0)\Big(1 -\frac{\alpha_1^2 +\alpha_1^2\alpha_2 + \alpha_2^2 - \alpha_2^3}{1-\alpha_2} \Big) =   \sigma^2 \\
&\gamma(0)\Big( \frac{(1 - \alpha_2)-\alpha_1^2 -\alpha_1^2\alpha_2 - \alpha_2^2 + \alpha_2^3}{1-\alpha_2} \Big) =   {\sigma^2}\\
&\gamma(0) =   \frac{\sigma^2(1-\alpha_2)}{{1 - \alpha_2-\alpha_1^2 -\alpha_1^2\alpha_2 - \alpha_2^2 + \alpha_2^3} }
\end{aligned}
$$
Then, we can evaluate at our given $\alpha_1$ and $\alpha_2$, simplifying the fraction using Python to avoid human error.
```{python}
from sympy import *

alpha_1, alpha_2, sigma_sq = symbols('alpha_1 alpha_2 sigma_sq')

gamma_0_expr = ( sigma_sq * (1 - alpha_2) / 
    (1 - alpha_2 - alpha_1**2 - alpha_1**2 * alpha_2 - alpha_2**2 + alpha_2**3))

alpha_1_val = Rational(7, 10)
alpha_2_val = Rational(-1, 10)

gamma_0_eval = gamma_0_expr.subs({alpha_1: alpha_1_val, alpha_2: alpha_2_val})

gamma_0_simplified = nsimplify(gamma_0_eval)
print(gamma_0_simplified)
```
Then, we can verify both our results and Python's simplification as follows, assuming $\sigma^2 = 1$. 
```{r}
set.seed(3)
alpha_1 <- 7/10
alpha_2 <- -1/10
sigma_sq <- 1 

gamma_0 <- (sigma_sq * (1 - alpha_2) / 
        (1 - alpha_2 - alpha_1^2 - alpha_1^2 * alpha_2 - alpha_2^2 + alpha_2^3))

ar_params <- c(alpha_1, alpha_2)
simulated_data <- arima.sim(n = 5000000, 
                            model = list(ar = c(7/10, -1/10)))

simulated_gamma_0 <- var(simulated_data)
# use both regular and simplified fraction version
cat("Computed Variance Using Simplified Fraction:", 275/162, "\n")
cat("Computed Variance Using Computation:", gamma_0, "\n")
cat("Variance of Simulated AR(2) process:", simulated_gamma_0, "\n")
```
It seems the computation very closely approximates the truth. Hence, we conclude that:
$$
f(\omega) = \gamma(0)f^{\star}(\omega) = \frac{275\sigma^2}{162}\Bigg( \dfrac{1}{\pi} + \frac{32}{11 \pi} \bigg(\frac{2\cos(\omega) - 1}{5 - 4\cos(\omega)}\bigg)- \frac{5}{11 \pi}  \bigg(\dfrac{5\cos(\omega) - 1}{13 - 5\cos(\omega)}\bigg) \Bigg)
$$
\newpage


## Part C


Plot the normalized spectral density and comment on its behaviour.


The normalized spectral density equation ended up being quite long, so we'll define each term one-by-one in the function below:
```{r}
f = function(w){
  term_1 = 1
  term_2 = (32/11)*((2*cos(w) - 1) / (5 - 4*cos(w)))
  term_3 = (5 /11)*((5*cos(w) - 1) / (13 - 5*cos(w)))
  return ( (1/pi)*(term_1 + term_2 - term_3) )
}
```
Then, we plot the function for a long sequence of $\omega$ values in $(0, \pi)$:
```{r}
omega = seq(from = 0, to = pi, length.out = 1e4)
# define data frame for values
p1df = data.frame(omega = omega,
           f_star_omega = f(omega))
# build plot
p1 <- ggplot(p1df, aes(x = omega, y = f_star_omega)) +
  geom_line(color = "#ff8600", linewidth = 0.1) +
  labs(
    title = "Normalized Spectral Density for AR(2) Process",
    subtitle = TeX(paste(
      "$X_t = \\alpha_1 X_{t-1} + \\alpha_2 X_{t-2} + Z_t$",
      "where",
      "$\\{\\,Z_t\\,\\}_{t \\in {Z}} \\sim WN(0, \\sigma^2)$",
      "and $\\alpha_1 =$7/10, $\\alpha_2 =-$1/10")),
    y = TeX("Normalized Spectral Density   $f^{*}(\\omega)$"),
    x = TeX("Frequency  $\\omega \\in (0, \\pi)$")
  ) + theme_bw() +
  geom_hline(yintercept = 0, lty = 'dashed', col = "darkgrey")+
  scale_x_continuous(
    breaks = c(0, pi/4, pi/2, 3*pi/4, pi), 
    labels = c(TeX("0"), TeX("$\\pi$/4"), TeX("$\\pi$/2"),
               TeX("$3\\pi$/4"), TeX("$\\pi$")))+
  theme(panel.grid.minor = element_line(
    color = "grey90",
    linetype = "dashed",
    linewidth = 0.5
  ))
print(p1)
```
**Comments**: It appears that the normalized spectral density plot is largely dominated by low frequencies. We can tell this is the case due to the fact that the largest values of $f^{\star}(\omega)$ is for small $\omega \in (0, \pi)$ specifically for $\omega \in (0, \pi/4)$ we see the majority of frequencies with observed normalized density greater than $0.5$. This tells us that a greater proportion of the variance inherent in the process $X_t$ can be attributed to the lower frequencies. As we would expect of a normalized spectral density dominated by low $\omega$ values, we see that $f^{\star}(\omega)$ is strictly decreasing as $\omega \rightarrow \pi$.

```{r, include=FALSE}
#h = -1000:-1
omega <- pi/4
inf <- 10000
sum_neg <- sum(sapply(-inf:-1, function(k) rho(-k) * exp(-1i * omega * k)))
sum_pos <- sum(sapply(1:inf, function(k) rho(k) * exp(-1i * omega * k)))
F_omega <- (1 / pi) * (1 + sum_neg + sum_pos)
Re(F_omega)
f(omega)
```


\newpage
# Question 2

Given the spectral density function

$$
f(\omega) = \frac{1}{\pi}\Big(62 - 70 \cos(\omega) + 12\cos(2 \omega) \Big), \hspace{0.5cm} \omega \in (0, 1)
$$
compute the autocovariance function $\gamma(h)$ and autocorrelation function $\rho(h)$ of the underlying
stochastic process, where $h \in \mathbb{Z}$.


We will begin with computing the autocovariance function $\gamma(h)$ at lag  $h = 0$, then at $h = 1$, $k = 2$ and finally $h > 2$.


Further, for notational simplicity, we let $a = 62$, $b = 70$ and $c = 12$, meaning that:
$$
f(\omega) = \frac{1}{\pi}\Big(a - b \cos(\omega) + c\cos(2 \omega) \Big), \hspace{0.5cm} \omega \in (0, 1)
$$

## Part A: Lag 0

For $h = 0$, we have the following:

$$
\gamma(0) = \int_0^{\pi} f(\omega)\cos(h \omega)\text{d}\omega =\int_0^{\pi} \bigg[  \frac{1}{\pi}\Big(a - b \cos(\omega) + c\cos(2 \omega) \Big)\bigg]\cos(0 \times \omega) \text{d}\omega 
$$
Let's evaluate this integral to find the autocovariance at lag zero.
$$
\begin{aligned}
\gamma(0) &= \int_0^{\pi}\bigg[  \frac{1}{\pi}\Big(a - b \cos(\omega) + c\cos(2 \omega) \Big)\bigg]\cos(0) \text{d}\omega \\
\gamma(0) &=  \frac{a}{\pi}\int_0^{\pi} \text{d}\omega - \frac{b}{\pi}\int_0^{\pi}  \cos(\omega)\text{d}\omega + \frac{c}{\pi}\int_0^{\pi} \cos(2 \omega) \text{d}\omega \\
\gamma(0) &=  \frac{a}{\pi}\Big(\omega \, \Big|_{0}^{\pi}\Big)- \frac{b}{\pi}\Big(\sin(\omega) \, \Big|_{0}^{\pi}\Big) + \frac{c}{\pi}\Big(\frac{1}{2}\sin(2\omega) \, \Big|_{0}^{\pi}\Big) \\
\gamma(0) &=  \frac{a}{\pi}(\pi - 0)- \frac{b}{\pi}\Big(\sin(\pi) - \sin(0)\Big) + \frac{c}{2\pi}\Big(\sin(2\pi) - \sin(0)\Big) \\
\gamma(0) &=  a- \frac{b}{\pi}\Big(0 -0\Big) + \frac{c}{2\pi}\Big(0 - 0\Big) \\
\gamma(0) &=  a = \boxed{62}
\end{aligned}
$$



## Part B: Lag 1

We repeat these calculations, but now for $h = 1$. We retain  $a = 62$, $b = 70$ and $c = 12$.

For $h = 1$, we have the following:

$$
\gamma(1) = \int_0^{\pi} f(\omega)\cos(h \omega)\text{d}\omega =\int_0^{\pi} \bigg[  \frac{1}{\pi}\Big(a - b \cos(\omega) + c\cos(2 \omega) \Big)\bigg]\cos(1 \times \omega) \text{d}\omega 
$$

As before, we expand and evaluate this integral. 


We will use the following trigonometric identities without proof:
$$
\cos^2(\theta) = 1 - \sin^2(\theta) \tag{3}
$$
$$
\sin^2(\theta) = \frac{1}{2}\big(1 - \cos(2\theta) \big) \tag{4}
$$


$$
\begin{aligned}
\gamma(1) &= \int_0^{\pi}\bigg[  \frac{1}{\pi}\Big(a - b \cos(\omega) + c\cos(2 \omega) \Big)\bigg]\cos(\omega) \text{d}\omega \\
\gamma(1) &=  \frac{a}{\pi}\int_0^{\pi} \cos(\omega) \text{d}\omega - \frac{b}{\pi}\int_0^{\pi}  \cos(\omega)\cos(\omega)\text{d}\omega + \frac{c}{\pi}\int_0^{\pi} \cos(2 \omega)\cos(\omega) \text{d}\omega \\
\gamma(1) &=  \frac{a}{\pi}\Big(\sin(\omega) \, \Big|_{0}^{\pi}\Big)- \frac{b}{\pi}\int_0^{\pi}  \cos^2(\omega)\text{d}\omega + \frac{c}{\pi}\int_0^{\pi} \cos(\omega) \cos(2 \omega)\text{d}\omega \\
\gamma(1) &= 0 - \frac{b}{\pi}\int_0^{\pi}  \big(1 - \sin^2(\omega) \big)\text{d}\omega + \frac{c}{\pi}\int_0^{\pi} \cos(\omega) \cos(2 \omega)\text{d}\omega \hspace{0.65cm} \text{ applying } (3) \\
\gamma(1) &= -\frac{b}{\pi}\int_0^{\pi}\text{d}\omega  + \frac{b}{\pi}\int_0^{\pi}\sin^2(\omega) \text{d}\omega + \frac{c}{\pi}\int_0^{\pi} \cos(\omega) \cos(2 \omega)\text{d}\omega \\
\gamma(1) &= -{b} + \frac{b}{\pi}\int_0^{\pi}\frac{1}{2}\big(1 - \cos(2\theta) \big)  \text{d}\omega + \frac{c}{\pi}\int_0^{\pi} \cos(\omega) \cos(2 \omega)\text{d}\omega \hspace{0.65cm} \text{ applying } (4) \\
\gamma(1) &= -{b} + \frac{b}{\pi}\int_0^{\pi}\frac{1}{2}\text{d}\omega - \frac{b}{2\pi}\underbrace{\int_0^{\pi} \cos(2\theta)\text{d}\omega}_{\text{shown to be 0 in Part A}} + \frac{c}{\pi}\int_0^{\pi} \cos(\omega) \cos(2 \omega)\text{d}\omega \\
\gamma(1) &= -{b} + \frac{b}{\pi}\int_0^{\pi}\frac{1}{2}\text{d}\omega  + \frac{c}{\pi}\int_0^{\pi} \cos(\omega) \cos(2\omega)\text{d}\omega \\
\gamma(1) &= -{b} + \frac{b}{2}  + \frac{c}{\pi}\int_0^{\pi} \cos(\omega) \cos(2\omega)\text{d}\omega
\end{aligned}
$$
We apply a manipulation of equation (4) to evaluate the final integral:
$$
\begin{aligned}
\gamma(1) &= -\frac{b}{2}  + \frac{c}{\pi}\int_0^{\pi} \cos(\omega) \cos(2\omega)\text{d}\omega \\
\gamma(1) &= -\frac{b}{2}  + \frac{c}{\pi}\int_0^{\pi} \cos(\omega)\Big(1 - 2\sin^2(\omega)\Big)\text{d}\omega \\
\gamma(1) &= -\frac{b}{2}  + \frac{c}{\pi}\int_0^{\pi} \cos(\omega)\text{d}\omega - \frac{2c}{\pi}\int_0^{\pi} \cos(\omega)\sin^2(\omega)\text{d}\omega \\
\gamma(1) &= -\frac{b}{2}  + \frac{c}{\pi}\Big(\sin(\omega) \, \Big|_{0}^{\pi}\Big) - \underbrace{\frac{2c}{\pi}\int_0^{\pi} \cos(\omega)\sin^2(\omega)\text{d}\omega}_{\text{let } q\, = \,\sin(\omega)} \\
\gamma(1) &= -\frac{b}{2}  + 0 - \frac{2c}{\pi} \int_0^{\pi} \cos(\omega)q^2\Big(\frac{1}{\cos(\omega)}\Big)\text{d}q \\
\gamma(1) &= -\frac{b}{2} - \frac{2c}{3\pi} \bigg( q^3 \Big|_{\omega = 0}^{\pi} \bigg) \\ 
\gamma(1) &= -\frac{b}{2} - \frac{2c}{3\pi} \bigg( \sin^3(\pi) - \sin^3(0) \bigg) \\
\gamma(1) &= -\frac{b}{2} = -\frac{70}{2} = \boxed{-35}
\end{aligned}
$$


\newpage
## Part C: Lag 2

We repeat these calculations, but now for $h = 2$. We retain  $a = 62$, $b = 70$ and $c = 12$.

For $h = 2$, we have the following:

$$
\gamma(2) = \int_0^{\pi} f(\omega)\cos(h \omega)\text{d}\omega =\int_0^{\pi} \bigg[  \frac{1}{\pi}\Big(a - b \cos(\omega) + c\cos(2 \omega) \Big)\bigg]\cos(2 \times \omega) \text{d}\omega 
$$

As before, we expand $f(\omega)$ and evaluate this integral. 
$$
\begin{aligned}
\gamma(2) &= \int_0^{\pi}\bigg[  \frac{1}{\pi}\Big(a - b \cos(\omega) + c\cos(2 \omega) \Big)\bigg]\cos(2\omega) \text{d}\omega \\
\gamma(2) &=  \frac{a}{\pi}\int_0^{\pi} \cos(2\omega) \text{d}\omega - \frac{b}{\pi}\underbrace{\int_0^{\pi}  \cos(\omega)\cos(2\omega)\text{d}\omega}_{\text{Shown in Part B to be zero.}} + \frac{c}{\pi}\int_0^{\pi} \cos(2 \omega)\cos(2\omega) \text{d}\omega \\
\gamma(2) &=  \frac{a}{2\pi}\Big( \sin(2\omega) \Big|_{0}^{\pi}\Big) - \frac{b}{\pi}(0)+ \frac{c}{\pi}\int_0^{\pi} \cos^2(2 \omega)\text{d}\omega, \hspace{0.65cm} \text{ applying } (3) \\
\gamma(2) &=  \frac{a}{2\pi}\Big( \sin(2\pi) - \sin(0)\Big) + \frac{c}{\pi}\int_0^{\pi} \Big(1 - \sin^2( 2\omega) \Big)\text{d}\omega  \\
\gamma(2) &=  \frac{a}{2\pi}( 0) + \frac{c}{\pi}\int_0^{\pi}1\text{d}\omega - \frac{c}{\pi}\int_0^{\pi}\sin^2( 2\omega)\text{d}\omega  \\
\gamma(2) &=  \frac{c}{\pi}(\pi)- \frac{c}{\pi}\int_0^{\pi}\frac{1}{2}\Big(1 - \cos(2\cdot2\omega)\Big)\text{d}\omega,  \hspace{0.65cm} \text{ applying } (4)\\
\gamma(2) &=  c - \frac{c}{2\pi}\int_0^{\pi}1\text{d}\omega + \frac{c}{2\pi}\int_0^{\pi} \cos(4\omega)\text{d}\omega \\
\gamma(2) &=  c - \frac{c}{2\pi}(\pi)+ \frac{c}{2\pi}\Big( \frac{1}{4} \sin(4\omega) \Big|_{0}^{\pi}\Big) \\
\gamma(2) &=  c - \frac{c}{2}+ \frac{c}{8\pi}\Big(\sin(4\pi) - \sin(0)\Big) \\
\gamma(2) &=  \frac{c}{2}  = \frac{12}{2} = \boxed{6}
\end{aligned}
$$


## Part D: Lags Greater Than 2



Before we evaluate lags $h > 2 \subset \mathbb{Z}$, we will establish the following lemma:



\textit{\underline{Lemma 1}}: Let $m \in \mathbb{Z}, n \in \mathbb{Z}^{+}$ We will show that:
$$
\forall (m,n) \in \mathbb{Z}^{+} \text { s.t. } m \neq n, \; \int_0^{\pi} \cos(m \omega)\cos(n \omega)\,\text{d}\omega = 0
$$
\textit{\underline{Proof}}: In order to show this equality holds, we will use the following product-to-sum identity of cosines without proof. Let $\theta, \vartheta \in \mathbb{R}$.
$$
\cos(\theta)\cos(\vartheta) = \frac{1}{2}\cos(\theta +\vartheta) + \frac{1}{2}\cos(\theta -\vartheta) \tag{2.1}
$$
We will use $(2.1)$ to evaluate the integral.
$$
\begin{aligned}
\int_0^{\pi} \cos(m \omega)\cos(n \omega)\,\text{d}\omega &= \int_0^{\pi} \bigg( \frac{1}{2}\cos(m \omega + n\omega) +  \frac{1}{2}\cos(m \omega - n\omega)\bigg)\,\text{d}\omega \\
\int_0^{\pi} \cos(m \omega)\cos(n \omega)\,\text{d}\omega &= \frac{1}{2}\int_0^{\pi} \underbrace{\cos\big((m + n)\omega\big)}_{\text{Let } q = (m+n)\omega}\,\text{d}\omega + \frac{1}{2}\int_0^{\pi} \underbrace{\cos\big((m - n)\omega\big)}_{\text{Let } \nu = (m-n)\omega}\,\text{d}\omega \\
\int_0^{\pi} \cos(m \omega)\cos(n \omega)\,\text{d}\omega &= \frac{1}{2(m+n)}\int_0^{\pi} \cos(q) \,\text{d}q + \frac{1}{2(m - n)}\int_0^{\pi} \cos(\nu)\,\text{d}\nu, \hspace{0.75cm} \text{requires } m \neq n\\
\int_0^{\pi} \cos(m \omega)\cos(n \omega)\,\text{d}\omega &= \frac{1}{2(m+n)}\Big( \sin(q)\Big|_{\omega = 0}^{\pi}\Big)+ \frac{1}{2(m - n)} \Big( \sin(\nu)\Big|_{\omega = 0}^{\pi}\Big) \\
\int_0^{\pi} \cos(m \omega)\cos(n \omega)\,\text{d}\omega &= \frac{1}{2(m+n)}\Big( \sin(m\omega + n\omega)\Big|_{0}^{\pi}\Big)+ \frac{1}{2(m - n)} \Big( \sin(m\omega - n\omega)\Big|_{0}^{\pi}\Big) \\
\int_0^{\pi} \cos(m \omega)\cos(n \omega)\,\text{d}\omega &= \frac{1}{2(m+n)}\Big( \sin\big((m+n)\pi\big) - \sin(0)\Big)+ \frac{1}{2(m - n)} \Big( \sin\big((m-n)\pi\big) - \sin(0)\Big)\Big) \\
\int_0^{\pi} \cos(m \omega)\cos(n \omega)\,\text{d}\omega &= \frac{1}{2(m+n)}\sin\big((m+n)\pi\big) + \frac{1}{2(m - n)} \sin\big((m-n)\pi\big) 
\end{aligned}
$$
We note that $m \in \mathbb{Z}$ and $n \in \mathbb{Z}$. Hence, by properties of integers, we know that $m + n \in \mathbb{Z}$ and $m - n \in \mathbb{Z}$. 

We can hence note that:
$$
(m \in \mathbb{Z} \land n \in \mathbb{Z}) \implies \exists \ell \in \mathbb{Z} \text{ s.t. } \ell = m + n
$$
Since $(m, n) \in \mathbb{Z}^{+}$ and $m \neq n$, we know that $m + n > 0, \; \therefore \ell > 0$ .


Similarly, we have that:
$$
(m \in \mathbb{Z} \land n \in \mathbb{Z}) \implies \exists \varrho \in \mathbb{Z} \text{ s.t. } \varrho = m - n
$$
Further, since $(m, n) \in \mathbb{Z}^{+}$ and $m \neq n$, we know that $\varrho \neq 0$. We also note by properties of sine that $\forall k \in \mathbb{Z}, \sin(k \cdot \pi) = 0.$



Finally, we can rewrite our simplified integral in terms of $\ell$ and $\varrho$ and solve.
$$
\begin{aligned}
\int_0^{\pi} \cos(m \omega)\cos(n \omega)\,\text{d}\omega &= \frac{1}{2\ell}\sin(\ell \pi) + \frac{1}{2 \varrho} \sin(\varrho \pi) \\
\int_0^{\pi} \cos(m \omega)\cos(n \omega)\,\text{d}\omega &= \frac{1}{2\ell}(0) + \frac{1}{2 \varrho}(0), \hspace{0.25cm} \text{ since } \forall k \in \mathbb{Z}, \sin(k \cdot \pi) = 0 \\
\int_0^{\pi} \cos(m \omega)\cos(n \omega)\,\text{d}\omega &= (0) + (0), \hspace{1.45cm} \text{ since }  \ell \neq 0 \text{ and } \varrho \neq 0 \\
\int_0^{\pi} \cos(m \omega)\cos(n \omega)\,\text{d}\omega &= 0
\end{aligned}
$$
Hence, we conclude that
$$
\forall (m,n) \in \mathbb{Z}^{+} \text { s.t. } m \neq n, \; \int_0^{\pi} \cos(m \omega)\cos(n \omega)\,\text{d}\omega = 0, \hspace{0.25cm}\text{ as required.} \;\;\square
$$



**Application of the Lemma**


Now, we can show that $\forall h > 2 \subseteq \mathbb{Z}^{+}$ that:
$$
\gamma(h) = \int_0^{\pi}f(\omega)\cos(h \omega) \text{d}\omega = 0
$$
\textit{\underline{Proof}}: We begin by expanding $f(\omega)$ with our previous variable assignments:
$$
\begin{aligned}
\int_0^{\pi}f(\omega)\cos(h \omega) \text{d}\omega &= \int_0^{\pi} \bigg[  \frac{1}{\pi}\Big(a - b \cos(\omega) + c\cos(2 \omega) \Big)\bigg]\cos(h \omega) \text{d}\omega \\
\int_0^{\pi}f(\omega)\cos(h \omega) \text{d}\omega &= \frac{a}{\pi}\int_0^{\pi} \cos(h \omega) \text{d}\omega - \frac{b}{\pi}\int_0^{\pi} \cos(\omega)\cos(h \omega)  \text{d}\omega + \frac{c}{\pi}\int_0^{\pi} \cos(2\omega)\cos(h \omega)  \text{d}\omega \\
\int_0^{\pi}f(\omega)\cos(h \omega) \text{d}\omega &= \frac{a}{\pi}\int_0^{\pi} \cos(0 \cdot\omega)\cos(h \cdot\omega) \text{d}\omega - \frac{b}{\pi}\int_0^{\pi} \cos(1 \cdot\omega)\cos(h \cdot\omega)  \text{d}\omega + \frac{c}{\pi}\int_0^{\pi} \cos(2 \cdot\omega)\cos(h \cdot\omega)  \text{d}\omega
\end{aligned}
$$
Now, from the expansion on the third line, we can draw an interesting parallel to the lemma established previously. Let $M = \{0, 1, 2\}$ and $N = \{n \in \mathbb{Z} : n >2\}$. 

We see by construction of these sets $M \cap N = \emptyset$. Importantly,
$$
M \cap N = \emptyset \; \implies \; \forall n \in N, \forall m \in M, \; m \neq n
$$
Now, if we let $M =  \{m_1, m_2, m_3\} = \{0, 1, 2\}$ and $n \in N := \{h \in \mathbb{Z} :  h>2\}$, we can rewrite our integral in terms of $m$ and $n$ and simplify using our lemma. 

$$
\begin{aligned}
\int_0^{\pi}f(\omega)\cos(h \omega) \text{d}\omega &= \frac{a}{\pi}\int_0^{\pi} \underbrace{ \cos(m_1 \cdot\omega)\cos(n \cdot\omega) }_{\forall n \in N,  \, m_1 \neq n } \text{d}\omega - \frac{b}{\pi}\int_0^{\pi} \underbrace{\cos(m_2 \cdot\omega)\cos(n \cdot\omega)}_{\forall n \in N,  \, m_2 \neq n }  \text{d}\omega + \frac{c}{\pi}\int_0^{\pi} \underbrace{\cos(m_2 \cdot\omega)\cos(n \cdot\omega)}_{\forall n \in N,  \, m_3 \neq n }  \text{d}\omega \\
\int_0^{\pi}f(\omega)\cos(h \omega) \text{d}\omega &= \frac{a}{\pi}(0)- \frac{b}{\pi}(0)+ \frac{c}{\pi}(0), \text{ by set construction and Lemma 1.} \\
\int_0^{\pi}f(\omega)\cos(h \omega) \text{d}\omega &= \boxed{0}
\end{aligned}
$$
So, we can conclude that:
$$
\forall h > 2, \gamma(h) = \int_0^{\pi}f(\omega)\cos(h \omega) \text{d}\omega = 0, \text{ as required.} \hspace{0.25cm} \square
$$


## Conclusions

Hence, bringing all the previous parts together, we can conclude that for $h \in \mathbb{Z}$:

$$
\gamma(h) = \begin{cases} \gamma(-h), & h < 0 \\
62, & h = 0 \\
-35, & h = 1 \\
6, & h = 2 \\
0, & \text{otherwise}
\end{cases}
$$
Similarly, we find $\rho(h)$ for $h \in \mathbb{Z}$ by dividing $\gamma(h)$ by $\sigma^2_{X} = \gamma(0)= 62$.
$$
\rho(h) = \begin{cases} \rho(-h), & h < 0 \\
1, & h = 0 \\
-35/62, & h = 1 \\
3/31, & h = 2 \\
0, & \text{otherwise}
\end{cases}
$$
We can also provide a plot of the theoretical ACF to get a more easily interpretable idea of how the autocorrelation of $X_t$ changes for lags $h \in \mathbb{Z}$.

```{r}
p2DF = data.frame(
  h = 0:9,
  rh = c(1, -35/62, 3/31, rep(0, times = 7))
)
p2 <- ggplot(p2DF, aes(x = h, y = rh)) +
  geom_segment(aes(xend = h, yend = 0),
               color = "#FF70A6",
               linewidth = 1.1) +
  geom_hline(yintercept = 0,
             linetype = "dashed",
             color = "darkgray") +
  labs(x = "Lag",  y = TeX("Theoretical $\\rho(h)$ Values"),
       title =  TeX(paste("Theoretical ACF Given Spectral Density $f(\\omega)$", 
       "for $\\omega \\in (0, 1)$ and $h \\in Z$")) )+
  theme_bw() +
  theme(panel.grid.minor = element_line(color = "grey90", 
                                        linetype = "dashed", linewidth = 0.5))
print(p2)
```


# Question 3


The data file `accel_watch.csv` contains three axes of accelerometer data for a test subject
that was walking at a steady pace while wearing a biologging watch. The accelerometer data
was recorded in meters per second squared and measured every 0.05 seconds (i.e., at a rate of
20 observations per second)


## Part A: Data Preprocessing and Investigation

### Part A.1.


Read the data into R.

```{r part_a1}
df = read.csv("accel_watch.csv")
```

### Part A.2.
Create a vector that contains the magnitude of acceleration at each time index.

We will use the following to define the column:
$$
\| \vec{a}\| = \sqrt{a_x^2 + a_y^2 + a_z^2}
$$

```{r part_a2}
df$Mag = sqrt(df$Ax^2 + df$Ay^2 + df$Az^2)
kable( t( head(df$Mag) ), caption = "Preview of $\\| \\vec{a} \\|$ Vector")
```
### Part A.3.


Coerce the vector into a time series object. 



We are told that the accelerometer data was recorded in meters per second squared and measured every 0.05 seconds (i.e., at a rate of
20 observations per second.) Hence, we set `frequency = 20`, as `?ts` informs us that the `frequency` parameter is "the number of observations per unit of time."

```{r, part_a3}
accel_ts = ts(df$Mag, frequency = 20)
```

### Part A.4.


Plot the resulting time series and its sample acf. (Make sure to properly label the
axes and provide titles for the plots.)


\underline{Time Series Plot}

```{r, part_a4_1}
# coerce time series into a plottable object
p3DF = fortify.zoo(accel_ts)
# build plot
p3 <- ggplot(p3DF, aes(x = Index, y = accel_ts)) +
  geom_line(color = "#70D6FF", linewidth = 0.8) +
  labs(
    title = TeX(paste("Acceleration Magnitude",
    "$\\| \\textbf{a} \\|$ of Subject over Time, in $(m / s^2)$")),
    subtitle = "Test Subject Walking at Steady Pace, Wearing a Biologging watch.",
    y = TeX("Acceleration Magnitude  $\\| \\textbf{a} \\|$  in $(m / s^2)$"),
    x = TeX("Elapsed Time (seconds)")
  ) + theme_bw() +
  theme(panel.grid.minor = element_line(
    color = "grey90",
    linetype = "dashed",
    linewidth = 0.5
  ))
# show results
print(p3)
```

\underline{Sample ACF}


```{r part_a4_2}
# get sample acf values
p5DF = data.frame(
  h = 0:36,
  rh = acf(accel_ts, plot = FALSE, lag.max = 36)$acf
)
# find n for WN bound calculation
n = length(accel_ts)
# create plot
p5 <- ggplot(p5DF, aes(x = h, y = rh)) +
  geom_hline(yintercept = 2/sqrt(n),
             linetype = "dashed",
             col = "#59054d") +
  geom_hline(yintercept = -2/sqrt(n),
             linetype = "dashed",
             col = "#59054d") +
  ylim(-0.4, 1) +
  geom_segment(aes(xend = h, yend = 0),
               color = "#b846a7",
               linewidth = 1) +
  geom_hline(yintercept = 0,
             linetype = "dashed",
             color = "#33172f") +
  labs(x = "Lag",  y = "ACF Values",
   title = TeX(paste("Correlogram of Acceleration Magnitude",
    "$\\| \\textbf{a} \\|$ of Subject")),
  subtitle = paste("Test Subject Walking at Steady Pace for appx.",
  "Six Seconds, Wearing a Biologging Watch")) +
  theme_bw()
print(p5)
```

### Part A.5.


Comment on what you observe.

<!-- Periodicity, perhaps due to natural swinging of arm as the subject was walking contributing to periodic $z$-axis acceleration 
also a slight negative trend, perhaps due to the subject slowing down their walking as the experiment window drew closer to the end (decreasing x and y axis acceleration slightly.-->

## Part B

### Part B.1.

Plot the raw periodogram for the series.

```{r, part_b1}
# compute raw periodogram
raw_pdg = spec.pgram(accel_ts, log = "no", plot = F)
# coerce to data frame
p6DF = data.frame(
  Frequency = raw_pdg$freq,
  Spectrum =  raw_pdg$spec
)
# plot
p6 <- ggplot(p6DF, aes(x = Frequency, y = Spectrum)) +
  geom_hline(yintercept = 0,  linetype = "dashed", color = "#909342") +
  geom_segment(aes(
    x = Frequency,   xend = Frequency,
    y = 0,  yend = Spectrum,
  ), color = "#d4d692")+
  geom_line(color = "#909342", linewidth = 0.5) +
  geom_point(color = "#909342", fill = "#ebeda6", pch = 21) +
  labs(
    title = "Raw Periodogram of Acceleration Magnitude Time Series",
    subtitle = paste(
      "Test Subject Walking at Steady Pace,",
      "Wearing a Biologging Watch for appx. 6s."
    ),
    y = TeX("Observed Spectrum"),
    x = TeX("Frequency")
  ) +
  theme_bw() +
  theme(panel.grid.minor = element_line(
    color = "grey90",
    linetype = "dashed",
    linewidth = 0.5
  ))
print(p6)
```

**Comments**: Dominated by low frequencies, two peaks in spectrum magnitude at (...) and (...), tails off into noise as $f \uparrow$, for higher frequencies. Thereby we know a (... larger proportion of the total variation in the series is attributed to the lower frequencies in the series (?))




### Part B.2.


```{r}
LOC = which.max(raw_pdg$spec)

# all relevant data for this maximum

print(paste("Spectrum at Max:", raw_pdg$spec[LOC]))
print(paste("Angular Frequency at Max:", 2*pi*raw_pdg$freq[LOC]))
print(paste("Acceleration at Max:",  accel_ts[LOC]))
print(paste("Elapsed Time at Max:", time(accel_ts)[LOC]))
```

Angular Frequency: $\omega = (2\pi)/T$ where $T$ is period, and  $\omega = 2\pi f$ where $f$ is frequency.
<!-- import numpy as np -->

<!-- # Define the constants A1, A2, d1, d2, and omega (fixed frequency for comparison) -->
<!-- A1 = 16 / 11 -->
<!-- A2 = 5 / 11 -->
<!-- d1 = 1 / 2 -->
<!-- d2 = 1 / 5 -->
<!-- omega = np.pi / 4  # Example fixed frequency -->

<!-- # Function to compute the sum of the first N terms for both parts of the sum -->
<!-- def sum_first_N_terms(N, omega): -->
<!--     sum_term1 = sum(A1 * (d1 ** abs(h)) * np.cos(omega * h) for h in range(1, N + 1)) -->
<!--     sum_term2 = sum(A2 * (d2 ** abs(h)) * np.cos(omega * h) for h in range(1, N + 1)) -->
<!--     return sum_term1 - sum_term2 -->

<!-- # Compute the sum of the first few terms -->
<!-- N = 100  # Number of terms to sum -->
<!-- sum_approx = sum_first_N_terms(N, omega) -->

<!-- # Compute the expression directly for comparison -->
<!-- expr_direct = (A1 * ((d1 * np.cos(omega)) - d1**2)) / (1 - 2 * d1 * np.cos(omega) + d1**2) - \ -->
<!--               (A2 * ((d2 * np.cos(omega)) - d2**2)) / (1 - 2 * d2 * np.cos(omega) + d2**2) -->

<!-- sum_approx, expr_direct -->

<!-- \cos\left( k\omega \right) =\left( e^{\mathbf{i}k\omega}+e^{-\mathbf{i}k\omega }\right) /2, -->
